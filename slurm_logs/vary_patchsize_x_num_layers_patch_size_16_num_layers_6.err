wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sjaiswa3 (diffusion-stepbystep) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: creating run
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /data/user_data/mprabhud/shantanu/vlr_project_logs2/wandb/run-20250423_162605-v81xsjfp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 16x6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/diffusion-stepbystep/vlr-project
wandb: üöÄ View run at https://wandb.ai/diffusion-stepbystep/vlr-project/runs/v81xsjfp
Run id: v81xsjfp

Loaded checkpoint: /data/user_data/mprabhud/shantanu/vlr_project_logs2/vlr-project/16x6/checkpoints/last.ckpt
Ignored keys: <All keys matched successfully>

SLURM_JOB_ID: 4618852
SLURM_ARRAY_TASK_ID: N/A
/data/user_data/mprabhud/mamba/envs/vlr_project/lib/python3.13/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python train.py patch_size=16 num_layers=6 exp_group=vary_p ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA L40S') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

/data/user_data/mprabhud/mamba/envs/vlr_project/lib/python3.13/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:654: Checkpoint directory /data/user_data/mprabhud/shantanu/vlr_project_logs2/vlr-project/16x6/checkpoints exists and is not empty.
Restoring states from the checkpoint path at /data/user_data/mprabhud/shantanu/vlr_project_logs2/vlr-project/16x6/checkpoints/last.ckpt
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name            | Type             | Params | Mode 
-------------------------------------------------------------
0 | model           | ViT              | 52.2 M | train
1 | resize_image    | Compose          | 0      | train
2 | norm_image      | Compose          | 0      | train
3 | resize_and_norm | Compose          | 0      | train
4 | crit            | CrossEntropyLoss | 0      | train
-------------------------------------------------------------
52.2 M    Trainable params
0         Non-trainable params
52.2 M    Total params
208.878   Total estimated model params size (MB)
88        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /data/user_data/mprabhud/shantanu/vlr_project_logs2/vlr-project/16x6/checkpoints/last.ckpt
[rank: 0] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.735
[rank: 3] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.735
[rank: 1] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.735
[rank: 2] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.735
[rank: 2] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.742
[rank: 0] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.742
[rank: 1] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.742
[rank: 3] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.742
[rank: 1] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.748
[rank: 3] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.748
[rank: 2] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.748
[rank: 0] Metric val/t1_acc improved by 0.007 >= min_delta = 0.001. New best score: 0.748
[rank: 0] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.753
[rank: 2] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.753
[rank: 3] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.753
[rank: 1] Metric val/t1_acc improved by 0.005 >= min_delta = 0.001. New best score: 0.753
[rank: 0] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.758
[rank: 2] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.758
[rank: 3] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.758
[rank: 1] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.758
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.761
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.761
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.761
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.761
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.762
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.762
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.762
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.762
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.766
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.766
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.766
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.766
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.767
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.767
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.767
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.767
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.770
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.770
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.770
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.770
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.773
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.773
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.773
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.773
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.774
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.774
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.774
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.774
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.776
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.776
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.776
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.776
[rank: 3] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.780
[rank: 2] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.780
[rank: 1] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.780
[rank: 0] Metric val/t1_acc improved by 0.004 >= min_delta = 0.001. New best score: 0.780
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.782
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.782
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.782
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.782
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.785
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.785
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.785
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.785
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.786
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.786
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.786
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.786
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.789
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.789
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.789
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.789
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.791
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.791
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.791
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.791
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.793
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.793
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.793
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.793
[rank: 0] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.795
[rank: 2] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.795
[rank: 3] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.795
[rank: 1] Metric val/t1_acc improved by 0.003 >= min_delta = 0.001. New best score: 0.795
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.797
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.797
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.797
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.797
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.798
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.798
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.798
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.798
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.799
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.799
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.799
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.799
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.801
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.801
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.801
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.801
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.803
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.803
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.803
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.803
[rank: 0] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.804
[rank: 2] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.804
[rank: 3] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.804
[rank: 1] Metric val/t1_acc improved by 0.001 >= min_delta = 0.001. New best score: 0.804
[rank: 0] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.806
[rank: 2] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.806
[rank: 1] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.806
[rank: 3] Metric val/t1_acc improved by 0.002 >= min_delta = 0.001. New best score: 0.806
slurmstepd: error: *** JOB 4618852 ON babel-4-21 CANCELLED AT 2025-04-24T16:26:09 DUE TO TIME LIMIT ***
